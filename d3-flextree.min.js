!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.d3=t.d3||{})}(this,function(t){"use strict";function n(t){var n=0,e=t.children,r=e&&e.length;if(r)for(;--r>=0;)n+=e[r].value;else n=1;t.value=n}function e(t,n){var e,i,l,h,c,a=new u(t),f=+t.value&&(a.value=t.value),s=[a];for(null==n&&(n=r);e=s.pop();)if(f&&(e.value=+e.data.value),(l=n(e.data))&&(c=l.length))for(e.children=Array(c),h=c-1;h>=0;--h)s.push(i=e.children[h]=new u(l[h])),i.parent=e,i.depth=e.depth+1;return a.eachBefore(o)}function r(t){return t.children}function i(t){t.data=t.data.data}function o(t){var n=0;do t.height=n;while((t=t.parent)&&t.height<++n)}function u(t){this.data=t,this.depth=this.height=0,this.parent=null}u.prototype=e.prototype={constructor:u,count:function t(){return this.eachAfter(n)},each:function t(n){var e,r,i,o,u=this,l=[u];do for(e=l.reverse(),l=[];u=e.pop();)if(n(u),r=u.children)for(i=0,o=r.length;i<o;++i)l.push(r[i]);while(l.length);return this},eachAfter:function t(n){for(var e,r,i,o=this,u=[o],l=[];o=u.pop();)if(l.push(o),e=o.children)for(r=0,i=e.length;r<i;++r)u.push(e[r]);for(;o=l.pop();)n(o);return this},eachBefore:function t(n){for(var e,r,i=this,o=[i];i=o.pop();)if(n(i),e=i.children)for(r=e.length-1;r>=0;--r)o.push(e[r]);return this},sum:function t(n){return this.eachAfter(function(t){for(var e=+n(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)e+=r[i].value;t.value=e})},sort:function t(n){return this.eachBefore(function(t){t.children&&t.children.sort(n)})},path:function t(n){for(var e=this,r=function t(n,e){if(n===e)return n;var r=n.ancestors(),i=e.ancestors(),o=null;for(n=r.pop(),e=i.pop();n===e;)o=n,n=r.pop(),e=i.pop();return o}(e,n),i=[e];e!==r;)e=e.parent,i.push(e);for(var o=i.length;n!==r;)i.splice(o,0,n),n=n.parent;return i},ancestors:function t(){for(var n=this,e=[n];n=n.parent;)e.push(n);return e},descendants:function t(){var n=[];return this.each(function(t){n.push(t)}),n},leaves:function t(){var n=[];return this.eachBefore(function(t){t.children||n.push(t)}),n},links:function t(){var n=this,e=[];return n.each(function(t){t!==n&&e.push({source:t.parent,target:t})}),e},copy:function t(){return e(this).eachBefore(i)}};var l=function(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")},h=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),c=function(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)},a=function(t,n){if(!t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return n&&("object"==typeof n||"function"==typeof n)?n:t},f=function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function t(n,e){var r=[],i=!0,o=!1,u=void 0;try{for(var l,h=n[Symbol.iterator]();!(i=(l=h.next()).done)&&(r.push(l.value),!e||r.length!==e);i=!0);}catch(c){o=!0,u=c}finally{try{!i&&h.return&&h.return()}finally{if(o)throw u}}return r}(t,n);throw TypeError("Invalid attempt to destructure non-iterable instance")},s=Object.freeze({children:function t(n){return n.children},nodeSize:function t(n){return n.data.size},spacing:0});function d(t){var n=Object.assign({},s,t);function r(t){var e=n[t];return"function"==typeof e?e:function(){return e}}function i(t){var n,e,i,f=u((n=o(),e=r("nodeSize"),i=r("spacing"),function(t){function n(t){l(this,n);var e=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return Object.assign(e,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:e,lExtRelX:0,lThr:null,rExt:e,rExtRelX:0,rThr:null}),e}return c(n,t),h(n,[{key:"spacing",value:function t(n){return i(this.data,n.data)}},{key:"update",value:function t(){return p(this),g(this),this}},{key:"size",get:function t(){return e(this.data)}},{key:"x",get:function t(){return this.data.x},set:function t(n){this.data.x=n}},{key:"y",get:function t(){return this.data.y},set:function t(n){this.data.y=n}}]),n}(n)),t,function(t){return t.children});return f.update(),f.data}function o(){var t=r("nodeSize"),n=r("spacing");return function(e){function r(t){return l(this,r),a(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t))}return c(r,e),h(r,[{key:"copy",value:function t(){var n=u(this.constructor,this,function(t){return t.children});return n.each(function(t){return t.data=t.data.data}),n}},{key:"spacing",value:function t(e){return n(this,e)}},{key:"size",get:function n(){return t(this)}},{key:"nodes",get:function t(){return this.descendants()}},{key:"xSize",get:function t(){return this.size[0]}},{key:"ySize",get:function t(){return this.size[1]}},{key:"top",get:function t(){return this.y}},{key:"bottom",get:function t(){return this.y+this.ySize}},{key:"left",get:function t(){return this.x-this.xSize/2}},{key:"right",get:function t(){return this.x+this.xSize/2}},{key:"root",get:function t(){var n=this.ancestors();return n[n.length-1]}},{key:"numChildren",get:function t(){return this.hasChildren?this.children.length:0}},{key:"hasChildren",get:function t(){return!this.noChildren}},{key:"noChildren",get:function t(){return null===this.children}},{key:"firstChild",get:function t(){return this.hasChildren?this.children[0]:null}},{key:"lastChild",get:function t(){return this.hasChildren?this.children[this.numChildren-1]:null}},{key:"extents",get:function t(){return(this.children||[]).reduce(function(t,n){return r.maxExtents(t,n.extents)},this.nodeExtents)}},{key:"nodeExtents",get:function t(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}],[{key:"maxExtents",value:function t(n,e){return{top:Math.min(n.top,e.top),bottom:Math.max(n.bottom,e.bottom),left:Math.min(n.left,e.left),right:Math.max(n.right,e.right)}}}]),r}(e.prototype.constructor)}function u(t,n,e){return function n(r,i){var o=new t(r);Object.assign(o,{parent:i,depth:null===i?0:i.depth+1,height:0,length:1});var u=e(r)||[];return o.children=0===u.length?null:u.map(function(t){return n(t,o)}),o.children&&Object.assign(o,o.children.reduce(function(t,n){return{height:Math.max(t.height,n.height+1),length:t.length+n.length}},o)),o}(n,null)}return Object.assign(i,{nodeSize:function t(e){return arguments.length?(n.nodeSize=e,i):n.nodeSize},spacing:function t(e){return arguments.length?(n.spacing=e,i):n.spacing},children:function t(e){return arguments.length?(n.children=e,i):n.children},hierarchy:function t(e,r){var i=void 0===r?n.children:r;return u(o(),e,i)},dump:function t(n){var e=r("nodeSize");return(function t(n){return function(r){var i=n+"  ",o=n+"    ",u=r.x,l=r.y,h=e(r),c=r.children||[],a=0===c.length?" ":","+i+"children: ["+o+c.map(t(o)).join(o)+i+"],"+n;return"{ size: ["+h.join(", ")+"],"+i+"x: "+u+", y: "+l+a+"},"}})("\n")(n)}}),i}d.version="2.1.2";var p=function t(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n.y=e,(n.children||[]).reduce(function(e,r){var i=f(e,2),o=i[0],u=i[1];t(r,n.y+n.ySize);var l=(0===o?r.lExt:r.rExt).bottom;0!==o&&y(n,o,u);var h=z(l,o,u);return[o+1,h]},[0,null]),v(n),_(n),n},g=function t(n,e,r){void 0===e&&(e=-n.relX-n.prelim,r=0);var i=e+n.relX;return n.relX=i+n.prelim-r,n.prelim=0,n.x=r+n.relX,(n.children||[]).forEach(function(e){return t(e,i,n.x)}),n},v=function t(n){(n.children||[]).reduce(function(t,n){var e=f(t,2),r=e[0],i=e[1],o=r+n.shift,u=i+o+n.change;return n.relX+=u,[o,u]},[0,0])},y=function t(n,e,r){for(var i=n.children[e-1],o=n.children[e],u=i,l=i.relX,h=o,c=o.relX,a=!0;u&&h;){u.bottom>r.lowY&&(r=r.next);var f=l+u.prelim-(c+h.prelim)+u.xSize/2+h.xSize/2+u.spacing(h);(f>0||f<0&&a)&&(c+=f,x(o,f),$(n,e,r.index,f)),a=!1;var s=u.bottom,d=h.bottom;s<=d&&(u=E(u))&&(l+=u.relX),s>=d&&(h=m(h))&&(c+=h.relX)}!u&&h?X(n,e,h,c):u&&!h&&k(n,e,u,l)},x=function t(n,e){n.relX+=e,n.lExtRelX+=e,n.rExtRelX+=e},$=function t(n,e,r,i){var o=n.children[e],u=e-r;if(u>1){var l=i/u;n.children[r+1].shift+=l,o.shift-=l,o.change-=i-l}},m=function t(n){return n.hasChildren?n.firstChild:n.lThr},E=function t(n){return n.hasChildren?n.lastChild:n.rThr},X=function t(n,e,r,i){var o=n.firstChild,u=o.lExt,l=n.children[e];u.lThr=r;var h=i-r.relX-o.lExtRelX;u.relX+=h,u.prelim-=h,o.lExt=l.lExt,o.lExtRelX=l.lExtRelX},k=function t(n,e,r,i){var o=n.children[e],u=o.rExt,l=n.children[e-1];u.rThr=r;var h=i-r.relX-o.rExtRelX;u.relX+=h,u.prelim-=h,o.rExt=l.rExt,o.rExtRelX=l.rExtRelX},_=function t(n){if(n.hasChildren){var e=n.firstChild,r=n.lastChild;Object.assign(n,{prelim:(e.prelim+e.relX-e.xSize/2+r.relX+r.prelim+r.xSize/2)/2,lExt:e.lExt,lExtRelX:e.lExtRelX,rExt:r.rExt,rExtRelX:r.rExtRelX})}},z=function t(n,e,r){for(;null!==r&&n>=r.lowY;)r=r.next;return{lowY:n,index:e,next:r}};t.flextree=d,Object.defineProperty(t,"__esModule",{value:!0})});